"use strict";var I=Object.defineProperty;var $=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var M=Object.prototype.hasOwnProperty;var N=(t,e)=>{for(var r in e)I(t,r,{get:e[r],enumerable:!0})},R=(t,e,r,u)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of L(e))!M.call(t,i)&&i!==r&&I(t,i,{get:()=>e[i],enumerable:!(u=$(e,i))||u.enumerable});return t};var _=t=>R(I({},"__esModule",{value:!0}),t);var w={};N(w,{default:()=>O});module.exports=_(w);var o=require("@raycast/api"),P=require("react");var v="Focus",g="Short Break",h="Long Break";var f=require("@raycast/api");var a=new f.Cache,c="pomodoro-interval/1.1",x="pomodoro-interval/completed-pomodoro-count",m=()=>Math.round(new Date().valueOf()/1e3);function k({parts:t}){return t.reduce((e,r)=>(typeof r.pausedAt<"u"?r.pausedAt-r.startedAt:m()-r.startedAt)+e,0)}function T(t){return k(t)/t.length*100}function C({parts:t}){return!!t[t.length-1].pausedAt}function b(t,e=!0){let r={type:t,length:J[t],parts:[{startedAt:m()}]};if(a.set(c,JSON.stringify(r)),e)a.set(x,"0");else{let u=parseInt(a.get(x)??"0",10);a.set(x,`${u+1}`)}return r}function y(){let t=p();if(t){let e=[...t.parts];e[e.length-1].pausedAt=m(),t={...t,parts:e},a.set(c,JSON.stringify(t))}return t}function A(){let t=p();if(t){let e=[...t.parts,{startedAt:m()}];t={...t,parts:e},a.set(c,JSON.stringify(t))}return t}function B(){a.remove(c)}function p(){let t=a.get(c);if(t)return JSON.parse(t)}var s=(0,f.getPreferenceValues)(),J={focus:parseInt(s.focusIntervalDuration)*60,"short-break":parseInt(s.shortBreakIntervalDuration)*60,"long-break":parseInt(s.longBreakIntervalDuration)*60};function S(t){if(t<=0)return"00:00";let e=Math.floor(t/60),r=t%60;return`${e<10?`0${e}`:e}:${r<10?`0${r}`:r}`}var n=require("react/jsx-runtime"),E={light:"#000000",dark:"#FFFFFF",adjustContrast:!1};function O(){let[t,e]=(0,P.useState)(p());if(t&&T(t)>=100)try{(0,o.launchCommand)({name:"pomodoro-control-timer",type:o.LaunchType.UserInitiated,context:{currentInterval:t}})}catch(l){console.error(l)}function r(l){e(b(l))}function u(){e(y())}function i(){e(A())}function F(){B(),e(void 0)}let d;d={source:"tomato-0.png",tintColor:E},t&&(d={source:`tomato-${100-Math.floor(T(t)/10)*10}.png`,tintColor:E});let D=s.enableTimeOnMenuBar?t?S(t.length-k(t)):"--:--":void 0;return(0,n.jsx)(o.MenuBarExtra,{icon:d,title:D,tooltip:"Pomodoro",children:t?(0,n.jsxs)(n.Fragment,{children:[C(t)?(0,n.jsx)(o.MenuBarExtra.Item,{title:"Continue",icon:o.Icon.Play,onAction:i,shortcut:{modifiers:["cmd"],key:"c"}}):(0,n.jsx)(o.MenuBarExtra.Item,{title:"Pause",icon:o.Icon.Pause,onAction:u,shortcut:{modifiers:["cmd"],key:"p"}}),(0,n.jsx)(o.MenuBarExtra.Item,{title:"Reset",icon:o.Icon.Stop,onAction:F,shortcut:{modifiers:["cmd"],key:"r"}})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.MenuBarExtra.Item,{title:v,subtitle:`${s.focusIntervalDuration}:00`,icon:"\u{1F3AF}",onAction:()=>r("focus"),shortcut:{modifiers:["cmd"],key:"f"}}),(0,n.jsx)(o.MenuBarExtra.Item,{title:g,subtitle:`${s.shortBreakIntervalDuration}:00`,icon:"\u{1F9D8}\u200D\u2642\uFE0F",onAction:()=>r("short-break"),shortcut:{modifiers:["cmd"],key:"s"}}),(0,n.jsx)(o.MenuBarExtra.Item,{title:h,subtitle:`${s.longBreakIntervalDuration}:00`,icon:"\u{1F6B6}",onAction:()=>r("long-break"),shortcut:{modifiers:["cmd"],key:"l"}})]})})}
